<?php /*

 Composr
 Copyright (c) ocProducts, 2004-2016

 See text/EN/licence.txt for full licencing information.


 NOTE TO PROGRAMMERS:
   Do not edit this file. If you need to make changes, save your changed file to the appropriate *_custom folder
   **** If you ignore this advice, then your website upgrades (e.g. for bug fixes) will likely kill your changes ****

*/

/**
 * @license    http://opensource.org/licenses/cpal_1.0 Common Public Attribution License
 * @copyright  ocProducts Ltd
 * @package    gallery_syndication
 */

i_solemnly_declare(I_UNDERSTAND_SQL_INJECTION | I_UNDERSTAND_XSS | I_UNDERSTAND_PATH_INJECTION);

require_code('oauth');

ensure_got_oauth_client_id('youtube', true);

$endpoint = 'https://accounts.google.com/o/oauth2';
$auth_url = $endpoint . '/auth?client_id=_CLIENT_ID_';
$auth_url .= '&redirect_uri=' . urlencode(static_evaluate_tempcode(build_url(array('page' => '_SELF'), '_SELF', null, false, true, true)));
$auth_url .= '&response_type=code';
$auth_url .= '&approval_prompt=force';
$auth_url .= '&scope=' . urlencode('https://gdata.youtube.com');
$auth_url .= '&access_type=offline';
$auth_url .= '&state=authorized';

retrieve_oauth2_token('youtube', 'YouTube', $auth_url, $endpoint);
